<meta:Type
  xmlns:meta="class:/spiralcraft/data/types/meta/"
  xmlns:bizm="class:/spiralcraft/biz/meta/"
  xmlns:ju="class:/java/util/"
  xmlns:time="class:/spiralcraft/time/"
  >
  
  <fields>
  
    <meta:SequenceField>
      <name>id
      </name>
      <type><LSID.type/>
      </type>
    </meta:SequenceField>
  
    <meta:Field>
      <name>displayName
      </name>
      <type><String.type/>
      </type>
    </meta:Field>
    
    <meta:Field>
      <name>daysUntilDue</name>
      <type><Integer.type/>
      </type>
    </meta:Field>
    
    
    
  </fields>

  <methods>
    <meta:Method>
      <name>dueDate
      </name>
      
      <parameterTypes>
        <ju:Date.type/>
      </parameterTypes>
      
      <returnType>
        <ju:Date.type/>
      </returnType>
      
      <contextX>{ invoiceDate:[@ju:Date] }      
      </contextX>
      
      <x>
        [bizm:PaymentTerms].daysUntilDue==null
        ?null
        :[@time:Calendar].@DEFAULT.add
          ([@time:Instant].@fromDate(invoiceDate)
          ,[@time:Duration].([bizm:PaymentTerms].daysUntilDue,[@time:Chronom].@DAY)
          ).toDate()
          
      </x>
    </meta:Method>
  </methods>
  
  <keys>
    <meta:Key>
      <name>paymentTerms
      </name>
      
      <primary>true
      </primary>
      
      <fieldList>id
      </fieldList>
      
    </meta:Key>


  </keys>
  
</meta:Type>